name: Install Factory to Remote

on:
  workflow_dispatch:
    inputs:
      target_repo:
        description: 'Target Repository URL (e.g., https://github.com/abiolaogu/VoxGuard)'
        required: true
        type: string

jobs:
  install-factory:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Factory (Source)
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install Logic Dependencies
        run: |
          # We need basic tools for the script to run
          pip install requests

      - name: Run Injection Script
        env:
          # This token allows the script to Push to the remote repo
          FACTORY_ADMIN_TOKEN: ${{ secrets.FACTORY_ADMIN_TOKEN }}
        run: |
          # We reuse the exact same script you use locally
          # This ensures consistency!
          python scripts/install_remote.py "${{ inputs.target_repo }}"

      - name: Installation Summary
        run: |
          echo "## ðŸ­ Factory Injection Complete" >> $GITHUB_STEP_SUMMARY
          echo "Target: ${{ inputs.target_repo }}" >> $GITHUB_STEP_SUMMARY
          echo "Status: âœ… Organs Transplated" >> $GITHUB_STEP_SUMMARY
